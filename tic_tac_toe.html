<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Caro Game 10x10 ƒê∆°n Gi·∫£n</title>
    <style>
        body { font-family: 'Courier New', monospace; }
        #game_status {
            font-size: 1.2em;
            font-weight: bold;
        }
        /* D√πng PRE ƒë·ªÉ hi·ªÉn th·ªã, gi√∫p m√£ ngu·ªìn JS ƒë∆°n gi·∫£n h∆°n nhi·ªÅu */
        #caro_game {
            font-size: 18px;
            line-height: 1.2;
        }
        button { padding: 8px 15px; cursor: pointer; }
    </style>
</head>
<body>
<h1>C·ªù caro b·∫£n thi·∫øu kinh ph√≠ (10x10)</h1>
<p id="game_status">L∆∞·ª£t ch∆°i: X</p>
<pre id="caro_game"></pre> <button type ="button" onclick="change_value()">Change Value</button>
<script>
    let x_display = document.getElementById("caro_game");
    let status_display = document.getElementById("game_status");

    // C√ÅC BI·∫æN C·ªê ƒê·ªäNH
    const N = 10;
    const M = 10;
    const WIN_COUNT = 5;

    // C√ÅC BI·∫æN TR·∫†NG TH√ÅI
    let bang = [];
    let nguoi_choi = 'x';
    let gameActive = true;
    let moveCount = 0;

    function initAndDrawBoard() {
        for (let i = 0; i < N; i++) {
            bang[i] = new Array(M).fill(0); // D√πng Array.fill(0) ƒë·ªÉ kh·ªüi t·∫°o nhanh h∆°n
        }
        drawBoard();
        updateStatus("L∆∞·ª£t ch∆°i c·ªßa: X");
    }

    // H√ÄM V·∫º B√ÄN C·ªú ƒê√É ƒê∆Ø·ª¢C ƒê∆†N GI·∫¢N H√ìA
    function drawBoard() {
        // D√πng map v√† join ƒë·ªÉ t·∫°o chu·ªói hi·ªÉn th·ªã nhanh ch√≥ng
        let output = bang.map(row =>
            row.join('  ') // N·ªëi c√°c ph·∫ßn t·ª≠ trong d√≤ng b·∫±ng 2 kho·∫£ng tr·∫Øng
        ).join('\n'); // N·ªëi c√°c d√≤ng b·∫±ng k√Ω t·ª± xu·ªëng d√≤ng (nh·ªù th·∫ª <pre>)

        x_display.textContent = "\n" + output; // D√πng textContent cho <pre>
    }

    function updateStatus(message) {
        status_display.innerHTML = message;
    }

    // ===================================
    // 2. LOGIC KI·ªÇM TRA TH·∫ÆNG (GI·ªÆ NGUY√äN)
    // ===================================

    function checkWin(row, col, player) {
        const directions = [
            [0, 1], [1, 0], [1, 1], [1, -1] // Ngang, D·ªçc, Ch√©o \ , Ch√©o /
        ];
        for (const [dr, dc] of directions) {
            let countPositive = countDirection(row, col, dr, dc, player);
            let countNegative = countDirection(row, col, -dr, -dc, player);
            if (countPositive + countNegative - 1 >= WIN_COUNT) {
                return true;
            }
        }
        return false;
    }

    function countDirection(r, c, dr, dc, player) {
        let count = 0;
        for (let i = 0; i < WIN_COUNT; i++) {
            let nextR = r + dr * i;
            let nextC = c + dc * i;
            if (nextR >= 0 && nextR < N && nextC >= 0 && nextC < M && bang[nextR][nextC] === player) {
                count++;
            } else {
                break;
            }
        }
        return count;
    }

    // ===================================
    // 3. X·ª¨ L√ù L∆Ø·ª¢T ƒê√ÅNH CH√çNH
    // ===================================

    function change_value() {
        if (!gameActive) {
            let winner = (nguoi_choi === 'x') ? 'O' : 'X';
            alert("Tr√≤ ch∆°i ƒë√£ k·∫øt th√∫c! Ng∆∞·ªùi chi·∫øn th·∫Øng l√† " + winner + ". Vui l√≤ng l√†m m·ªõi trang.");
            return;
        }

        // D√πng destructuring ƒë·ªÉ l·∫•y gi√° tr·ªã prompt, ƒë∆°n gi·∫£n h√≥a code
        let positionX = parseInt(prompt("L∆∞·ª£t " + nguoi_choi.toUpperCase() + ": Nh·∫≠p D√≤ng (0-" + (N - 1) + "):"));
        let positionY = parseInt(prompt("L∆∞·ª£t " + nguoi_choi.toUpperCase() + ": Nh·∫≠p C·ªôt (0-" + (N - 1) + "):"));

        // Ki·ªÉm tra t√≠nh h·ª£p l·ªá
        if (isNaN(positionX) || isNaN(positionY) || positionX < 0 || positionX >= N || positionY < 0 || positionY >= M) {
            alert("V·ªã tr√≠ kh√¥ng h·ª£p l·ªá. Vui l√≤ng nh·∫≠p s·ªë trong kho·∫£ng 0 ƒë·∫øn " + (N - 1) + ".");
            return;
        }

        // Ki·ªÉm tra √¥ ƒë√£ ƒë∆∞·ª£c ƒë√°nh ch∆∞a
        if (bang[positionX][positionY] !== 0) {
            alert("√î n√†y ƒë√£ ƒë∆∞·ª£c ƒë√°nh. Vui l√≤ng ch·ªçn √¥ kh√°c.");
            return;
        }

        // C·∫≠p nh·∫≠t gi√° tr·ªã
        bang[positionX][positionY] = nguoi_choi;
        drawBoard();
        moveCount++;

        // KI·ªÇM TRA TH·∫ÆNG
        if (checkWin(positionX, positionY, nguoi_choi)) {
            updateStatus("üéâ **CH√öC M·ª™NG!** Ng∆∞·ªùi ch∆°i **" + nguoi_choi.toUpperCase() + "** ƒë√£ th·∫Øng!");
            gameActive = false;
            return;
        }

        // KI·ªÇM TRA H√íA
        if (moveCount === N * M) {
            updateStatus("ü§ù **H√≤a!** B√†n c·ªù ƒë√£ ƒë·∫ßy.");
            gameActive = false;
            return;
        }

        // Chuy·ªÉn l∆∞·ª£t ch∆°i
        nguoi_choi = (nguoi_choi === 'x') ? 'o' : 'x';
        updateStatus("L∆∞·ª£t ch∆°i c·ªßa: " + nguoi_choi.toUpperCase());
    }

    // Kh·ªüi ƒë·ªông tr√≤ ch∆°i khi t·∫£i trang
    initAndDrawBoard();
</script>
</body>
</html>